---
title: 时钟运算
date: 2016-11-13 19:00:00
tags: [密码技术]
---

时钟运算是密码技术里面很常见的运算，在了解 Diffie-Hellman 密钥交换、RSA 之前，最好对时钟运算有一定的了解。

<!-- more -->

所谓时钟运算，实际上就是 **除法求余数的运算**。当时针指向 11 的时候，再过两小时，时针不会指向 13，而是回到了 1，因为钟面上最多只到 12。在这里，我们记为：

$$13mod\,12=1$$

在数论中，当整数 a，b 除以 m 所得余数相等的时候，则称 a，b 对于模 m 同余，记作：

$$a≡b(mod\,m)$$

读作 **a 同余于 b 模 m**，或 **a 与 b 对模 m 同余**。

也就是在上面的例子中，我们也可以写作：$13≡1(mod\,12)$，因为 1 模 12 的结果也是 1。

以上就是时钟运算，其实可能我们小学的时候就已经学过了，不过在这里我们将讨论一下几个基本运算中的变换。

## 乘法

$$(a \* b)\,mod\,n = ((a\,mod\,n) \* (b\,mod\,n))\,mod\,n$$

## 乘方

乘方其实就是特殊的乘法

$$a^b\,mod\,n = (a\,mod\,n)^b mod\,n$$

提到这两个运算的原因是我们可以通过上面这个等式快速计算诸如 $7^4 mod\,12 = ?$

显然，$7^4\,mod\,12 = 49^2\,mod\,12 = (49\,mod\,12)^2\,mod\,12 = 1\,mod\,12 = 1$，我们不必去计算 $7^4$ 是多少。

## 对数

乘方的逆运算称为对数，如果有一个式子 $7^? = 49$，我们一眼就能看出 ? 等于 2，但如果让你求 $7^?\,mod\,13 = 11$ 里的 ? 等于多少，我们得从 2 开始一个一个去算。

在时钟运算里面，这称为 **离散对数**。当数字很大的时候，求离散对数非常困难，也非常耗时。能快速求出离散对数的算法到现在为止还没有被发现。Diffie-Hellman 密钥交换协议和 ElGamal 公钥算法中就运用到了离散对数。

## 数论倒数

考虑存在两个数 a，b，有 $a \* b\,mod\,m = 1$，如果没有 mod 符号，当 $a \* b = 1$ 的时候，我们说 a 和 b 是互为倒数的关系，而在时钟运算里面，则称 a 和 b 互为关于模 m 的数论倒数。即

$$a * b ≡ 1 (mod\,m)$$

我们知道，除 0 以外的数都有倒数，那么在时钟运算里面是否也是如此呢？

首先，0 乘任何数再模任何数都是 0，所以 0 是没有关于模 12 的数论倒数的。

- $1 \* 1 mod 12 = 1$，1 存在
- 2 不存在
- 3 不存在
- 4 不存在
- $5 \* 5 mod 12 = 1$，5 存在
- 6 不存在
- $7 \* 7 mod 12 = 1$，7 存在
- 8 不存在
- 9 不存在
- 10 不存在
- $11 \* 1 mod 12 = 1$，11 存在

看来，并不是所有数字都有关于模 12 的数论倒数的，那么有什么规律？我们可能注意到，好像他们都是质数？其实并不是（1 就不是质数），而是当 a 和 12 **最大公约数为 1** 的时候，a 才存在关于模 12 的数论倒数。也就是 **a 和 12 互质**。

根据 欧拉定理（TODO）可以证明，如果两个正整数 a 和 n 互质，那么一定可以找到整数 b，使得 $a * b ≡ 1 (mod\,n)$。