---
title: 公钥密码
date: 2016-11-03 01:00:00
tags: [密码技术]
---

使用 git 的时候，每次换机器，都需要向 git 服务器提供 ssh 公钥，当有些机器上并没有的时候，可以使用命令生成一份，命令执行完后，会多两个文件，一个叫 `id_rsa.pub`，一个叫 `id_rsa`，前者称为 ssh 公钥，是需要提供给 git 服务器的，后者是私钥，一般我们就不会管了，但这个文件其实是不能泄露给他人的。

所以一直都有这些疑惑：

- 什么是公钥，什么是私钥？
- 为什么公钥能够公开，私钥必须保存？
- 公钥和私钥在通信过程中发挥了怎样的作用？

<!-- more -->

公钥又称为加密密钥，私钥又称为解密密钥，他们都是 **公钥密码** 中的密钥。在通信中，发送者通过公钥对消息进行加密，接受者通过私钥对消息进行解密，从而保证消息的 **机密性**。

说到公钥密码，就不能不先提一下 **对称密码**。

## 对称密码

当我们说要给一段消息加密的时候，最简单的想法可能就是发送者通过一个密钥给消息加密，接受者拿到消息后再根据这个密钥给消息解密。

举个栗子，好比发送者有一段为 `midnight` 的消息要发送给接受者，首先，我们对消息进行编码，取出消息中每个字母的 ASCII：

```
m -> 01101101
i -> 01101001
d -> 01100100
n -> 01101110
i -> 01101001
g -> 01100111
h -> 01101000
t -> 01110100
```

编码完之后，这段消息也就是：`0110110101101001011001000110111001101001011001110110100001110100`，然后发送者随机生成一个与消息等长的密钥，假设是 `01010101010101010101010101010101010101010101010101010101010101`，然后将消息和密钥进行 XOR 运算，生成的结果也就是密文。

```
明文 0110110101101001011001000110111001101001011001110110100001110100
密钥 0101010101010101010101010101010101010101010101010101010101010101
密文 0011100000111100001100010011101100111100001100100011110100100001
```

当接收者得到密文后，也与密钥进行 XOR 运算，即能得到明文。

在这个过程中，发送者加密时使用的密钥，和接收者解密时使用的密钥是一样的，这种密码算法就称为 **对称密码**。

与之不同的是，**公钥密码** 在加密和解密中使用了不同的密钥，也就是我们开头提到的公钥和私钥，因此，公钥密码又称为 **非对称密码**。

*另外，对称密码又称为私钥密码。*

## 公钥密码

了解了对称密码之后，你一定也有一个巨大的疑惑，就是接收者收到密文之后，是需要发送方的密钥来解密的，但是密钥怎么配送呢？

这也就是 **密钥配送问题**：**假如发送者能安全地把密钥发送给接收者，那为什么不通过这种方式把明文发送给接收者呢？**

好在，通过公钥密码可以解决这个问题。

公钥密码将密钥分为了 **加密密钥** 和 **解密密钥**，发送者通过加密密钥对消息进行加密，接收者通过解密密钥对消息进行解密，也就是说，解密密钥是一开始就由接收者自己保管的，因此只需要接收者将加密密钥发送给发送者就可以解决密钥配送问题了：因为根本不需要配送解密密钥！

流程图如下： 

![](http://7xo08n.com1.z0.glb.clouddn.com/blog/asymmetric-cryptography/01.png)

从图中我们可以得到以下信息：

- 发送者只需要公钥
- 接收者只需要私钥
- 私钥不能被窃听者获取
- 公钥被窃听者获取也没问题
- 通过公钥加密的消息，能够被私钥解密，但公钥无法解密密文

公钥和私钥是一一对应的，一对公钥和私钥统称为 **密钥对**。由公钥加密的密文必须使用与该公钥配对的私钥才能够解密。密钥对中的两个密钥之间具有非常密切的关系——数学上的关系——因此公钥和私钥是不能分别单独生成的。

在公钥密码中，使用最广泛的公钥密码算法是 RSA 加密算法。（TODO）